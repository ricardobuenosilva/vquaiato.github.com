--- 
layout: post
title: Silverlight 4 beta - Novas Features - Acessando Arquivos
wordpress_id: 222
wordpress_url: http://viniciusquaiato.com/blog/?p=222
categories: 
- title: .NET
  slug: dotnet
  autoslug: .net
- title: Visual Studio 2010
  slug: visual-studio-2010
  autoslug: visual-studio-2010
- title: Silverlight
  slug: silverlight
  autoslug: silverlight
tags: 
- title: Silverlight 4
  slug: silverlight-4
  autoslug: silverlight-4
- title: RIA
  slug: ria
  autoslug: ria
- title: Browser
  slug: browser
  autoslug: browser
---
Fala galera, beleza?Silverlight 4 - Capturando WebCam - [http://viniciusquaiato.com/blog/silverlight-4-capturando-webcam/](http://viniciusquaiato.com/blog/silverlight-4-capturando-webcam/)Vamos falar mais um pouco do silverlight 4 beta, desta vez vamos acessar arquivose pastas da máquina utilizando uma aplicação Silverlight rodando fora do browser (Out of Browser).Vamos abrir o Visual Studio 2010 beta 2 e criar uma nova aplicação Silverlight:[caption id="attachment_223" align="aligncenter" width="330" height="190"  caption="Criando projeto Silverlight (ampliar)"][![Criando projeto Silverlight](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Criando-projeto-Silverlight.jpg "Criando projeto Silverlight")](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Criando-projeto-Silverlight.jpg)[/caption]A interface utilizada será bem simples como mostra a imagem e o código XAML abaixo:[caption id="attachment_229" align="aligncenter" width="324" caption="Interface Silverlight"][![Interface Silverlight](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Interface-Silverlight.jpg "Interface Silverlight")](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Interface-Silverlight.jpg)[/caption]Código XAML:<pre lang="xml"><usercontrol x:class="OutOfBrowserFileAccess.MainPage" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:ignorable="d" d:designheight="335" d:designwidth="295" background="Black">    <border cornerradius="20" background="Black" width="305" height="320">        <grid x:name="LayoutRoot" background="Black" height="303" width="287">            <listbox height="103" horizontalalignment="Left" margin="12,12,0,0" name="listBox1" verticalalignment="Top" width="263" />            </grid></border></usercontrol><button foreground="Black" fontfamily="Verdana" fontsize="14" content="Listar" height="23" horizontalalignment="Left" margin="12,121,0,0" name="btnListar" verticalalignment="Top" width="263" click="btnListar_Click">            </button><button content="Gravar Arquivo" height="23" horizontalalignment="Left" margin="12,261,0,0" name="btnGravar" verticalalignment="Top" width="263" click="btnGravar_Click">            <textbox height="80" horizontalalignment="Left" margin="12,175,0,0" name="txtConteudoArquivo" verticalalignment="Top" width="263" acceptsreturn="True" />            </button></pre>Feito isso vamos implementar agora a listagem dos arquivos da pasta "Documents", como mostra a listagem do click do primeiro botão abaixo:<pre lang="csharp" line="1">private void btnListar_Click(object sender, RoutedEventArgs e){    var files = Directory.EnumerateFiles(                    Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments)                );    foreach (var item in files)        this.listBox1.Items.Add(item);}</pre>As linhas 3, 4 e 5 são as principais nesta listagem. Nelas estamos obtendo os nomes dos arquivos do diretório "Meus Documentos". Notem a utilização das classes Environment e Directory.Já nas linhas 7 e 8 estamos apenas adicionando os nomes dos arquivos à nossa ListBox.A listagem a seguir mostra como fazer a gravação de um arquivo texto também na pasta "Meus Documentos":<pre lang="csharp" line="1">private void btnGravar_Click(object sender, RoutedEventArgs e){    var streamWriter = File.CreateText(            System.IO.Path.Combine(                Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments), "Silverlight.txt")            );    streamWriter.WriteLine("Arquivo gerado pela app Silverlight...");    streamWriter.WriteLine("=======================================");    streamWriter.WriteLine(this.txtConteudoArquivo.Text);    streamWriter.Close();}</pre>Este também é um código bem simples. Na linha 3 estamos criando uma stream para a gravação de um arquivo, novamente utilizando a classe Environment (linha 4).Nas linhas 7, 8 e 9 gravamos o conteúdo do arquivo, e na linha 10 finalizamos nossas operações.Para que nossa aplicação rode fora do browser, vamos realizar esta configuração no projeto silverlight, como mostram as imagens abaixo:[caption id="attachment_234" align="aligncenter" width="330" caption="Configurando Silverlight Fora do Browser"][![Configurando Silverlight Fora do Browser](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Configurando-Silverlight-Fora-do-Browser.jpg "Configurando Silverlight Fora do Browser")](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Configurando-Silverlight-Fora-do-Browser.jpg)[/caption][caption id="attachment_235" align="aligncenter" width="330" caption="Configurando Silverlight Fora do Browser 2"][![Configurando Silverlight Fora do Browser 2](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Configurando-Silverlight-Fora-do-Browser-2.jpg "Configurando Silverlight Fora do Browser 2")](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Configurando-Silverlight-Fora-do-Browser-2.jpg)[/caption]Agora é preciso instalar nossa aplicação. Para isso basta iniciar a mesma, com F5 no Visual Studio. Quando a página abrir, basta clicar com o botão direito na página, como mostra a imagem abaixo:[caption id="attachment_237" align="aligncenter" width="330" caption="Instalando Aplicação Silverlight Fora do Browser"][![Instalando Aplicacao Silverlight Fora do Browser](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Instalando-Aplicacao-Silverlight-Fora-do-Browser.jpg "Instalando Aplicação Silverlight Fora do Browser")](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Instalando-Aplicacao-Silverlight-Fora-do-Browser.jpg)[/caption][caption id="attachment_238" align="aligncenter" width="330" caption="Instalando Aplicação Silverlight Fora do Browser 2"][![Instalando Aplicacao Silverlight Fora do Browser 2](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Instalando-Aplicacao-Silverlight-Fora-do-Browser-2.jpg "Instalando Aplicação Silverlight Fora do Browser 2")](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Instalando-Aplicacao-Silverlight-Fora-do-Browser-2.jpg)[/caption]E como resultado temos:[caption id="attachment_242" align="aligncenter" width="330" caption="Aplicacao Silverlight rodando fora do browser"][![Aplicacao Silverlight rodando fora do browser](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Aplicacao-Silverlight-rodando-fora-do-browser.jpg "Aplicacao Silverlight rodando fora do browser")](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Aplicacao-Silverlight-rodando-fora-do-browser.jpg)[/caption]E aqui podemos ver o arquivo gerado:[caption id="attachment_244" align="aligncenter" width="330" caption="Arquivo gerado pelo silverlight"][![Arquivo gerado pelo silverlight](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Arquivo-gerado-pelo-silverlight.jpg "Arquivo gerado pelo silverlight")](http://viniciusquaiato.com/blog/wp-content/uploads/2009/11/Arquivo-gerado-pelo-silverlight.jpg)[/caption]Bom é isso aê pessoal. [Quem quiser a solução Silverlight + C# pode ser baixada aqui.](http://www.viniciusquaiato.com/files/codesamples/silverlight4/acessandoArquivos.rar)Qualquer dúvida, é só entrar em contato.Abraços,Vinicius Quaiato.
